<!doctype html>

<html lang="vi">

<head>

<meta charset="utf-8" />

<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Ch√∫c m·ª´ng 20/10 üíå</title>

<style>

  :root{ --accent:#ff5f97; --muted:#ccc }

  body{

    margin:0; min-height:100vh;

    display:flex;align-items:flex-start;justify-content:center;

    font-family:"Segoe UI",system-ui,Arial; background:#fff0f6;

    padding:80px 16px;

  }

  .center { width:100%; max-width:900px; }



  /* th∆∞ */

  .letter{

    width:360px;padding:28px;border-radius:14px;

    background:linear-gradient(180deg,#ffd8e8,#fff0f6);

    box-shadow:0 10px 30px rgba(255,95,151,0.12);

    text-align:center;cursor:pointer;margin:0 auto;

  }

  .letter h2{margin:0 0 6px;font-size:22px}

  .heart{font-size:56px;color:#e91e63;margin:6px 0}

  .muted { color:#6b4756; font-size:14px }



  .hidden{ display:none !important; }



  /* khu v·ª±c ·∫£nh 1 */

  .first-area{

    display:none; 

    margin:28px auto; 

    text-align:center; 

  }

  .upload-label{

    display:inline-block;background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;

    cursor:pointer;font-weight:700;margin-bottom:12px;

  }

  input[type=file]{ display:none; }

  .preview{

    display:none;

    width:320px;height:320px;object-fit:cover;border-radius:12px;

    box-shadow:0 8px 20px rgba(0,0,0,0.08);cursor:pointer;

    margin:0 auto; /* cƒÉn gi·ªØa */

  }



  /* message + ·∫£nh2 */

  .message-wrap{ display:none; margin:28px auto; width:760px; max-width:95%; }

  .message{

    display:flex; gap:18px; align-items:flex-start; background:#fff8fb; border:2px solid #ffd2e6;

    padding:18px;border-radius:12px; box-shadow:0 10px 30px rgba(255,95,151,0.08);

    justify-content:space-between;

  }

  .messageText{

    flex:1; font-size:18px; line-height:1.6; color:#333; text-align:left;

  }

  .messageImg{

    width:160px; height:auto; border-radius:10px; object-fit:cover; border:2px solid #ffbfd6;

  }



  /* final */

  .final{

    display:none; margin-top:28px; font-size:36px; color:#ff2e7a; font-style:italic; font-weight:700;

    text-align:center; animation:fadeInText 1.6s ease forwards;

  }

  @keyframes fadeInText{from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:none}}



  /* responsive */

  @media (max-width:820px){

    .message{flex-direction:column;align-items:center}

    .messageImg{width:85%;height:auto}

  }

</style>

</head>

<body>

  <div class="center">



    <!-- B·ª®C TH∆Ø -->

    <div id="letter" class="letter" role="button" aria-label="B·ª©c th∆∞">

      <h2>G·ª≠i t·∫∑ng v·ª£ iu üíå</h2>

      <div class="heart">‚ù§Ô∏è</div>

      <div class="muted">(Click v√†o b·ª©c th∆∞ ƒë·ªÉ m·ªü qu√† nh√≥!)</div>

    </div>



    <!-- ·∫¢NH 1 (G·ª≠i t·∫∑ng em) - hi·ªán sau khi click th∆∞ -->

    <div id="firstArea" class="first-area">

      <label id="firstLabel" class="upload-label" for="firstFile">üì∏ G·ª≠i t·∫∑ng em</label>

      <input id="firstFile" type="file" accept="image/*" />

      <br>

      <img id="firstPreview" class="preview" alt="·∫¢nh g·ª≠i t·∫∑ng em" />

    </div>



    <!-- ƒêO·∫†N VƒÇN + ·∫¢NH 2 (hi·ªán sau khi click ·∫£nh 1) -->

    <div id="messageWrap" class="message-wrap">

      <div class="message" id="messageBox" role="region" aria-label="L·ªùi ch√∫c">

        <div id="messageText" class="messageText">

          Nh√¢n ng√†y 20/10, ch·ªìng xin ch√∫c v·ª£ iu c√≥ m·ªôt ng√†y th·∫≠t tr·ªçn v·∫πn v√† vui v·∫ª. Mong r·∫±ng em s·∫Ω th√≠ch v·ªõi m√≥n qu√† nh·ªè n√†y c·ªßa anh d√†nh t·∫∑ng cho em :"))); c√≥ th·ªÉ ƒë·ªçc t·ªõi ƒë√¢y em c∆∞·ªùi th·ªëi ru·ªôt m√† thoai khum sao, coi nh∆∞ ƒë√£ th√†nh c√¥ng t·∫°o ti·∫øng c∆∞·ªùi vui v·∫ª cho em r√πi. Hy v·ªçng r·∫±ng em s·∫Ω kh√¥ng t·ªßi th√¢n v√† y√™u anh nhi·ªÅu h∆°n n·ªØa nhaaa .<br><br>Anh y√™u v·ª£ nh√¨uu üòò

        </div>

        <img id="messageImg" class="messageImg" alt="·∫¢nh k√®m l·ªùi ch√∫c" />

      </div>

    </div>



    <!-- D√≤ng k·∫øt -->

    <div id="finalText" class="final">Design by Ch·ªìng em, PƒêT üëÆ‚Äç‚ôÇÔ∏è</div>



  </div>



<script>

(function(){

  const letter = document.getElementById('letter');

  const firstArea = document.getElementById('firstArea');

  const firstFile = document.getElementById('firstFile');

  const firstPreview = document.getElementById('firstPreview');

  const firstLabel = document.getElementById('firstLabel');



  const messageWrap = document.getElementById('messageWrap');

  const messageText = document.getElementById('messageText');

  const messageImg = document.getElementById('messageImg');

  const finalText = document.getElementById('finalText');



  const KEY1 = 'giftImage_v1';

  const KEY2 = 'cardImage_v1';

  const LOCK1 = 'giftLocked_v1';

  const LOCK2 = 'cardLocked_v1';



  function resetToLetterState(){

    letter.style.display = 'block';

    firstArea.style.display = 'none';

    firstPreview.style.display = 'none';

    messageWrap.style.display = 'none';

    finalText.style.display = 'none';

  }

  resetToLetterState();



  function lockInput(inputEl, labelEl){

    inputEl.disabled = true;

    labelEl.style.background = '#ccc';

    labelEl.style.cursor = 'not-allowed';

    labelEl.style.pointerEvents = 'none';

    labelEl.textContent = ''; // X√ìA d√≤ng "·∫¢nh ƒë√£ ƒë∆∞·ª£c g·ª≠i üíù"

  }



  letter.addEventListener('click', () => {

    letter.style.display = 'none';

    firstArea.style.display = 'block';

    const saved1 = localStorage.getItem(KEY1);

    const locked1 = localStorage.getItem(LOCK1);

    if(saved1){

      firstPreview.src = saved1;

      firstPreview.style.display = 'block';

      if(locked1 === 'true'){ lockInput(firstFile, firstLabel); }

    }

  });



  firstFile.addEventListener('change', (ev) => {

    const f = ev.target.files && ev.target.files[0];

    if(!f) return;

    if(localStorage.getItem(LOCK1) === 'true') return;

    const reader = new FileReader();

    reader.onload = function(e){

      const data = e.target.result;

      localStorage.setItem(KEY1, data);

      localStorage.setItem(LOCK1, 'true');

      firstPreview.src = data;

      firstPreview.style.display = 'block';

      lockInput(firstFile, firstLabel);

    };

    reader.readAsDataURL(f);

  });



  firstPreview.addEventListener('click', () => {

    firstArea.style.display = 'none';

    const saved2 = localStorage.getItem(KEY2);

    if(saved2){

      messageImg.src = saved2;

      messageImg.style.display = 'block';

      messageWrap.style.display = 'block';

      return;

    }

    const tmp = document.createElement('input');

    tmp.type = 'file'; tmp.accept = 'image/*';

    tmp.onchange = (e) => {

      const file = e.target.files && e.target.files[0];

      if(!file) return;

      if(localStorage.getItem(LOCK2) === 'true') return;

      const r = new FileReader();

      r.onload = function(evt){

        const data2 = evt.target.result;

        localStorage.setItem(KEY2, data2);

        localStorage.setItem(LOCK2, 'true');

        messageImg.src = data2;

        messageImg.style.display = 'block';

        messageWrap.style.display = 'block';

      };

      r.readAsDataURL(file);

    };

    tmp.click();

  });



  function showFinal(){

    messageWrap.style.display = 'none';

    finalText.style.display = 'block';

  }

  messageText.addEventListener('click', showFinal);

  messageImg.addEventListener('click', showFinal);

})();

</script>

</body>

</html>