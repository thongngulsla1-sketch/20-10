<!doctype html>

<html lang="vi">

<head>

<meta charset="utf-8" />

<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Ch√∫c m·ª´ng 20/10 üíå</title>

<style>

  :root{ --accent:#ff5f97; --muted:#ccc }

  body{

    margin:0; min-height:100vh;

    display:flex;align-items:flex-start;justify-content:center;

    font-family:"Segoe UI",system-ui,Arial; background:#fff0f6;

    padding:80px 16px;

    overflow-x:hidden;

  }

  .center { width:100%; max-width:900px; }



  /* Th∆∞ */

  .letter{

    width:360px;padding:28px;border-radius:14px;

    background:linear-gradient(180deg,#ffd8e8,#fff0f6);

    box-shadow:0 10px 30px rgba(255,95,151,0.12);

    text-align:center;cursor:pointer;margin:0 auto;

    opacity:1; transition:opacity 0.8s ease, transform 0.8s ease;

  }

  .letter.fadeOut { opacity:0; transform:scale(0.95); pointer-events:none; }

  .letter h2{margin:0 0 6px;font-size:22px}

  .heart{font-size:56px;color:#e91e63;margin:6px 0}

  .muted { color:#6b4756; font-size:14px }



  .hidden{ display:none !important; }



  /* ·∫¢nh ƒë·∫ßu ti√™n */

  .first-area{

    display:none;

    margin:28px auto;

    text-align:center;

    opacity:0;

    transform:translateY(20px);

    transition:opacity 1s ease, transform 1s ease;

  }

  .first-area.show { display:block; opacity:1; transform:translateY(0); }



  .upload-label{

    display:inline-block;background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;

    cursor:pointer;font-weight:700;margin-bottom:12px;

  }

  input[type=file]{ display:none; }



  .preview{

    display:none;

    width:320px;height:320px;object-fit:cover;border-radius:12px;

    box-shadow:0 8px 20px rgba(0,0,0,0.08);cursor:pointer;

    margin:18px auto;

    opacity:0; transform:scale(0.95);

    transition:opacity 1s ease, transform 1s ease;

  }

  .preview.show{ display:block; opacity:1; transform:scale(1); }



  /* ƒêo·∫°n vƒÉn + ·∫£nh 2 */

  .message-wrap{

    display:none;

    margin:28px auto;

    width:760px; max-width:95%;

    opacity:0; transform:translateY(20px);

    transition:opacity 1.2s ease, transform 1.2s ease;

  }

  .message-wrap.show{ display:block; opacity:1; transform:translateY(0); }



  .message{

    display:flex; gap:18px; align-items:center; justify-content:center;

    background:#fff8fb; border:2px solid #ffd2e6;

    padding:18px;border-radius:12px; box-shadow:0 10px 30px rgba(255,95,151,0.08);

    flex-direction: row;

  }

  .messageText{

    flex:1; font-size:18px; line-height:1.6; color:#333; text-align:left;

    max-width:520px;

  }

  .messageImg{

    width:160px; height:auto; border-radius:10px; object-fit:cover; border:2px solid #ffbfd6;

  }



  @media (max-width:820px){

    .message{flex-direction:column;align-items:center}

    .messageText{text-align:center}

    .messageImg{width:85%;height:auto}

  }



  /* Final */

  .final{

    display:none;

    margin-top:28px;

    font-size:36px; color:#ff2e7a; font-style:italic; font-weight:700;

    text-align:center;

    opacity:0; transform:translateY(20px);

    transition:opacity 1.2s ease, transform 1.2s ease;

  }

  .final.show { display:block; opacity:1; transform:translateY(0); }

</style>

</head>

<body>

  <div class="center">



    <div id="letter" class="letter">

      <h2>G·ª≠i t·∫∑ng v·ª£ iu üíå</h2>

      <div class="heart">‚ù§Ô∏è</div>

      <div class="muted">(Click v√†o b·ª©c th∆∞ ƒë·ªÉ m·ªü qu√†)</div>

    </div>



    <div id="firstArea" class="first-area">

      <label id="firstLabel" class="upload-label" for="firstFile">üì∏ G·ª≠i t·∫∑ng em</label>

      <input id="firstFile" type="file" accept="image/*" />

      <br>

      <img id="firstPreview" class="preview" alt="·∫¢nh g·ª≠i t·∫∑ng em" />

    </div>



    <div id="messageWrap" class="message-wrap">

      <div class="message" id="messageBox">

        <div id="messageText" class="messageText">

          Nh√¢n ng√†y 20/10, ch·ªìng xin ch√∫c v·ª£ iu c√≥ m·ªôt ng√†y th·∫≠t tr·ªçn v·∫πn v√† vui v·∫ª. Mong r·∫±ng em s·∫Ω th√≠ch v·ªõi m√≥n qu√† nh·ªè n√†y c·ªßa anh d√†nh t·∫∑ng cho em :"))); c√≥ th·ªÉ ƒë·ªçc t·ªõi ƒë√¢y em c∆∞·ªùi th·ªëi ru·ªôt m√† thoai khum sao, coi nh∆∞ ƒë√£ th√†nh c√¥ng t·∫°o ti·∫øng c∆∞·ªùi vui v·∫ª cho em r√πi. Hy v·ªçng r·∫±ng em s·∫Ω kh√¥ng t·ªßi th√¢n v√† y√™u anh nhi·ªÅu h∆°n n·ªØa nhaaa. <br><br>Anh y√™u v·ª£ nh√¨u üòò

        </div>

        <img id="messageImg" class="messageImg" alt="·∫¢nh k√®m l·ªùi ch√∫c" />

      </div>

    </div>



    <div id="finalText" class="final">Design by Ch·ªìng em, PƒêT üëÆ‚Äç‚ôÇÔ∏è</div>



  </div>



<script>

(function(){

  const letter = document.getElementById('letter');

  const firstArea = document.getElementById('firstArea');

  const firstFile = document.getElementById('firstFile');

  const firstPreview = document.getElementById('firstPreview');

  const firstLabel = document.getElementById('firstLabel');

  const messageWrap = document.getElementById('messageWrap');

  const messageText = document.getElementById('messageText');

  const messageImg = document.getElementById('messageImg');

  const finalText = document.getElementById('finalText');



  const KEY1 = 'giftImage_v1';

  const KEY2 = 'cardImage_v1';

  const LOCK1 = 'giftLocked_v1';

  const LOCK2 = 'cardLocked_v1';



  function resetToLetterState(){

    letter.style.display = 'block';

    firstArea.style.display = 'none';

    firstPreview.style.display = 'none';

    messageWrap.style.display = 'none';

    finalText.style.display = 'none';

  }

  resetToLetterState();



  function lockInput(inputEl, labelEl){

    inputEl.disabled = true;

    labelEl.style.background = '#ccc';

    labelEl.style.cursor = 'not-allowed';

    labelEl.style.pointerEvents = 'none';

    labelEl.textContent = '';

  }



  letter.addEventListener('click', () => {

    letter.classList.add('fadeOut');

    setTimeout(() => {

      letter.style.display = 'none';

      firstArea.style.display = 'block';

      requestAnimationFrame(() => firstArea.classList.add('show'));

      const saved1 = localStorage.getItem(KEY1);

      const locked1 = localStorage.getItem(LOCK1);

      if(saved1){

        firstPreview.src = saved1;

        firstPreview.style.display = 'block';

        requestAnimationFrame(() => firstPreview.classList.add('show'));

        if(locked1 === 'true') lockInput(firstFile, firstLabel);

      }

    }, 600);

  });



  firstFile.addEventListener('change', (ev) => {

    const f = ev.target.files && ev.target.files[0];

    if(!f) return;

    if(localStorage.getItem(LOCK1) === 'true') return;

    const reader = new FileReader();

    reader.onload = function(e){

      const data = e.target.result;

      localStorage.setItem(KEY1, data);

      localStorage.setItem(LOCK1, 'true');

      firstPreview.src = data;

      firstPreview.style.display = 'block';

      requestAnimationFrame(() => firstPreview.classList.add('show'));

      lockInput(firstFile, firstLabel);

    };

    reader.readAsDataURL(f);

  });



  firstPreview.addEventListener('click', () => {

    firstPreview.style.opacity = '0';

    firstPreview.style.transform = 'scale(0.95)';

    setTimeout(() => {

      firstArea.style.display = 'none';

      const saved2 = localStorage.getItem(KEY2);

      if(saved2){

        messageImg.src = saved2;

        messageImg.style.display = 'block';

        messageWrap.style.display = 'block';

        requestAnimationFrame(() => messageWrap.classList.add('show'));

        return;

      }

      const tmp = document.createElement('input');

      tmp.type = 'file'; tmp.accept = 'image/*';

      tmp.onchange = (e) => {

        const file = e.target.files && e.target.files[0];

        if(!file) return;

        if(localStorage.getItem(LOCK2) === 'true') return;

        const r = new FileReader();

        r.onload = function(evt){

          const data2 = evt.target.result;

          localStorage.setItem(KEY2, data2);

          localStorage.setItem(LOCK2, 'true');

          messageImg.src = data2;

          messageImg.style.display = 'block';

          messageWrap.style.display = 'block';

          requestAnimationFrame(() => messageWrap.classList.add('show'));

        };

        r.readAsDataURL(file);

      };

      tmp.click();

    }, 600);

  });



  function showFinal(){

    messageWrap.style.opacity = '0';

    messageWrap.style.transform = 'translateY(20px)';

    setTimeout(() => {

      messageWrap.style.display = 'none';

      finalText.style.display = 'block';

      requestAnimationFrame(() => finalText.classList.add('show'));

    }, 600);

  }

  messageText.addEventListener('click', showFinal);

  messageImg.addEventListener('click', showFinal);

})();

</script>

</body>

</html>